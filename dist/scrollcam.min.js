!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).ScrollingCamera=i()}(this,function(){return function(t){var i,e;function s(i,e){var s,n=e.x,h=void 0===n?0:n,o=e.y,r=void 0===o?0:o,a=e.width,d=e.height,l=e.start,c=void 0===l?0:l,p=e.end,u=void 0===p?5e3:p,v=e.wheel,m=void 0!==v&&v,g=e.drag,f=void 0===g?.95:g,_=e.minSpeed,w=void 0===_?4:_,y=e.snap,S=void 0!==y&&y,x=e.snapConfig,P=void 0===x?{}:x,b=e.horizontal,E=void 0!==b&&b;return(s=t.call(this,h,r,a,d)||this).scene=i,s.x=h,s.y=r,s.width=a||Number(s.scene.game.config.width),s.height=d||Number(s.scene.game.config.height),s.start=c,s.end=u-s.height,s.wheel=m,s.drag=f,s.minSpeed=w,s.snap=S,s.snapGrid=P,s.horizontal=E,s.snapGrid.padding=P.padding||20,s.snapGrid.deadZone=void 0===P.deadZone?.4:P.deadZone,s.init(),s}e=t,(i=s).prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e;var n=s.prototype;return n.init=function(){this.moving=!1,this.scrollX=this.horizontal&&this.start||this.x,this.scrollY=this.horizontal?this.y:this.start||this.y,this._rectangle=new Phaser.Geom.Rectangle(this.x,this.y,this.width,this.height),this._speed=0,this._start=this.scrollY,this._end=this.scrollY,this._startTime=0,this._endTime=0,this._scrollProp=this.horizontal?"scrollX":"scrollY",this.isOnSnap=!1,this.snapIndex=0,this.setDragEvent(),this.wheel&&this.setWheelEvent(),this.scene.time.addEvent({delay:500,callback:this.resetMoving,callbackScope:this,loop:!0}),this.scene.cameras.addExisting(this)},n.resetMoving=function(){this.moving=!1},n.setSpeed=function(t){var i=this;this._speed=t||(i._end-i._start)/((i._endTime-i._startTime)/1e3)},n.setDragEvent=function(){this.scene.input.on("pointermove",this.dragHandler,this),this.scene.input.on("pointerup",this.upHandler,this),this.scene.input.on("pointerdown",this.downHandler,this)},n.setWheelEvent=function(){window.addEventListener("wheel",this.wheelHandler.bind(this))},n.downHandler=function(){var t=this._scrollProp;this._speed=0,this._start=this[t],this._startTime=performance.now()},n.dragHandler=function(t){t.isDown&&this.isOver(t)&&(this.horizontal?this.scrollX-=t.position.x-t.prevPosition.x:this.scrollY-=t.position.y-t.prevPosition.y,this.moving=!0)},n.upHandler=function(){this._end=this.horizontal?this.scrollX:this.scrollY,this._endTime=performance.now(),this.isOnSnap=!1,this.moving&&this.setSpeed()},n.wheelHandler=function(t){this.isOver(this.scene.input.activePointer)&&(this[this._scrollProp]+=t.deltaY)},n.isOver=function(t){return this._rectangle.contains(t.x,t.y)},n.clampScroll=function(){var t=this._scrollProp;this[t]=Phaser.Math.Clamp(this[t],this.start,this.end),this._end=this[t]},n.update=function(t,i){var e=this._scrollProp;if(this[e]+=this._speed*(i/1e3),this._speed*=this.drag,Math.abs(this._speed)<this.minSpeed&&!this.isOnSnap&&(this._speed=0,this.snap&&!this.scene.input.activePointer.isDown)){var s=this.start,n=this.snapGrid.padding,h=(this[e]-s)/n;Math.abs(.5-h%1)>=this.snapGrid.deadZone/2&&(this[e]=s+Math.round(h)*n,this.snapIndex=this.getSnapIndex(this[e],s,n),this.isOnSnap=!0,this.emit("snap",this.snapIndex))}this.clampScroll()},n.getSnapIndex=function(t,i,e){return Math.round((t-i)/e)},n.destroy=function(){this.emit(Phaser.Cameras.Scene2D.Events.DESTROY,this),window.removeEventListener("wheel",this.wheelHandler),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null},s}(Phaser.Cameras.Scene2D.Camera)});
//# sourceMappingURL=scrollcam.min.js.map
